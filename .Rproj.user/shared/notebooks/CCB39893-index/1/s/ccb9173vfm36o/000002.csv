"0","# separate out the sub categories "
"0","scot_ghg_clean <- scot_ghg %>%"
"0","  # separate categories"
"0","  separate(col = ""source_name"", into = c(""source_name"", ""source_sub_cat""), sep = "" - "") %>% "
"0","  #structure data for sunburst"
"0","  mutate(source_sub_cat = to_sentence_case(source_sub_cat),"
"0","         inner_circle = ""GHG"","
"0","        # clean categories"
"0","         source_sub_cat = str_replace_all(source_sub_cat, ""[Hh]gv"", ""HGV""),"
"0","         source_sub_cat = str_replace_all(source_sub_cat, ""Lg vs"", ""LGVs""),"
"0","        # shorten sector names"
"0","         sg_categories = recode(sg_categories, "
"0","                                   ""Transport (excluding international aviation and shipping)"" = ""Domestic\nTransport"","
"0","                                   ""Agriculture and Related Land Use"" = ""Agriculture"","
"0","                                   ""Business and Industrial Process"" = ""Business\n&\nIndustry"")) %>%"
"0","  group_by(source_name) %>%"
"0","  # amalgamate sources which only have one sub category into one, to limit the number of off shoots on sunburst"
"0","  mutate("
"0","    source_sub_cat = case_when("
"0","    n_distinct(source_sub_cat) == 1 ~ NA_character_,"
"0","    TRUE ~ source_sub_cat"
"0","    ),"
"0","    #wrap names for better formatting"
"0","    source_name = str_wrap(source_name, 14),"
"0","    source_sub_cat = str_wrap(source_sub_cat, 14)"
"0","    )"
"2","Warning:"
"2"," Expected 2 pieces. Additional pieces discarded in 6547 rows [589, 590, 591, 592, 593, 594, 595, 596, 597, 598, 599, 600, 601, 602, 603, 604, 605, 606, 607, 608, ...].
"
"2","Warning:"
"2"," Expected 2 pieces. Missing pieces filled with `NA` in 4312 rows [145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, ...].
"
